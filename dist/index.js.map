{"version":3,"file":"index.js","sources":["../src/index.ts"],"sourcesContent":[null],"names":["compressStepsLossy","compressStateJSON","uncompressStateJSON","compressSelectionJSON","uncompressSelectionJSON","compressStepJSON","uncompressStepJSON","require","TIMESTAMP","changesRef","checkpointRef","selectionsRef","selfSelectionRef","selections","view","constructor","firebaseRef","stateConfig","constructView","clientID","selfClientID","push","key","progress","this_","this","child","onDisconnect","remove","selfChanges","selection","constructEditor","once","then","snapshot","d","k","latestKey","val","compressedStepJSONToStep","compressedStepJSON","Step","fromJSON","schema","updateCollab","docChanged","mapping","newState","hasOwnProperty","call","map","doc","sendable","sendableSteps","steps","transaction","existingBatchedSteps","s","step","toJSON","c","t","error","committed","dataSnapshot","console","Number","set","eq","Node","plugins","concat","collab","startAt","String","editor","changes","stepClientIDs","placeholderClientId","Math","random","keys","Object","max","compressedStepsJSON","Array","length","fill","dispatch","receiveTransaction","state","updateClientSelection","compressedSelection","Selection","warn","tr","on","destroy","bind","defineProperties","value","catch","_","off","Error"],"mappings":"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"}